
{"logicalRa": "Sequence[Store(public:adhoc:fb_q5_HC_LFJ)[Apply(x=$0,y=$10)[Select(((((((((($0 = $4) and ($1 = $2)) and ($3 = $9)) and ($5 = $6)) and ($7 = $15)) and ($10 = $12)) and ($11 = $8)) and ($13 = $14)) and ($3 > $15)))[CrossProduct[CrossProduct[CrossProduct[CrossProduct[CrossProduct[CrossProduct[CrossProduct[Scan(public:adhoc:actor_film), Scan(public:adhoc:perform_film)], Scan(public:adhoc:actor_film)], Scan(public:adhoc:perform_film)], Scan(public:adhoc:perform_film)], Scan(public:adhoc:actor_film)], Scan(public:adhoc:actor_film)], Scan(public:adhoc:perform_film)]]]]]", "rawQuery": "-- find actor/actor pair which have cooperated in at least two different movies\naf = scan(actor_film); -- 1,100,844\npf = scan(perform_film); -- 1,094,294\nquery = [from\n            af as r1, pf as r2,\n            af as r3, pf as r4,\n            pf as r6, af as r5,\n            af as r7, pf as r8\n         where r1.$0 = r3.$0 and -- actor 1\n               r1.$1 = r2.$0 and -- perf-film\n               r2.$1 = r6.$1 and -- the first same film by actor 1 and 2\n               r3.$1 = r4.$0 and -- second film by actor 1\n               r4.$1 = r8.$1 and -- the second same film by actor 1 and 2\n               r5.$0 = r7.$0 and -- actor 2\n               r5.$1 = r6.$0 and -- perf-film\n               r7.$1 = r8.$0 and\n               r2.$1 > r8.$1\n         emit r1.$0 as x, r5.$0 as y];\n-- Store\nstore(query, fb_q5_HC_LFJ);", "language": "myrial", "plan": {"fragments": [{"operators": [{"argOperatorId": 1, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 0}, {"opName": "MyriaInMemoryOrderBy(1+,0+)", "argAscending": [true, true], "argSortColumns": [1, 0], "argChild": 0, "opType": "InMemoryOrderBy", "opId": 2}, {"argOperatorId": 4, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 3}, {"opName": "MyriaInMemoryOrderBy(0+,1+)", "argAscending": [true, true], "argSortColumns": [0, 1], "argChild": 3, "opType": "InMemoryOrderBy", "opId": 5}, {"argOperatorId": 7, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 6}, {"opName": "MyriaInMemoryOrderBy(1+,0+)", "argAscending": [true, true], "argSortColumns": [1, 0], "argChild": 6, "opType": "InMemoryOrderBy", "opId": 8}, {"argOperatorId": 10, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 9}, {"opName": "MyriaInMemoryOrderBy(1+,0+)", "argAscending": [true, true], "argSortColumns": [1, 0], "argChild": 9, "opType": "InMemoryOrderBy", "opId": 11}, {"argOperatorId": 13, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 12}, {"opName": "MyriaInMemoryOrderBy(0+,1+)", "argAscending": [true, true], "argSortColumns": [0, 1], "argChild": 12, "opType": "InMemoryOrderBy", "opId": 14}, {"argOperatorId": 16, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 15}, {"opName": "MyriaInMemoryOrderBy(0+,1+)", "argAscending": [true, true], "argSortColumns": [0, 1], "argChild": 15, "opType": "InMemoryOrderBy", "opId": 17}, {"argOperatorId": 19, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 18}, {"opName": "MyriaInMemoryOrderBy(0+,1+)", "argAscending": [true, true], "argSortColumns": [0, 1], "argChild": 18, "opType": "InMemoryOrderBy", "opId": 20}, {"argOperatorId": 22, "opName": "MyriaHyperShuffleConsumer", "opType": "HyperShuffleConsumer", "opId": 21}, {"opName": "MyriaInMemoryOrderBy(0+,1+)", "argAscending": [true, true], "argSortColumns": [0, 1], "argChild": 21, "opType": "InMemoryOrderBy", "opId": 23}, {"argChildren": [23, 20, 17, 14, 11, 8, 5, 2], "opName": "MyriaLeapFrogJoin([[$0, $4], [$1, $2], [$3, $9], [$5, $6], [$7, $15], [$8, $11], [$10, $12], [$13, $14]])", "argColumnNames": ["actor", "film", "perf_id", "film_id", "actor1", "film1", "perf_id1", "film_id1", "perf_id11", "film_id11", "actor11", "film11", "actor111", "film111", "perf_id111", "film_id111"], "joinFieldMapping": [[[0, 0], [2, 0]], [[0, 1], [1, 0]], [[1, 1], [4, 1]], [[2, 1], [3, 0]], [[3, 1], [7, 1]], [[4, 0], [5, 1]], [[5, 0], [6, 0]], [[6, 1], [7, 0]]], "opType": "LeapFrogJoin", "opId": 24, "outputFieldMapping": [[0, 0], [0, 1], [1, 0], [1, 1], [2, 0], [2, 1], [3, 0], [3, 1], [4, 0], [4, 1], [5, 0], [5, 1], [6, 0], [6, 1], [7, 0], [7, 1]]}, {"argPredicate": {"rootExpressionOperator": {"right": {"columnIdx": 15, "type": "VARIABLE"}, "left": {"columnIdx": 3, "type": "VARIABLE"}, "type": "GT"}}, "argChild": 24, "opType": "Filter", "opName": "MyriaSelect(($3 > $15))", "opId": 25}, {"argChild": 25, "opType": "Apply", "opName": "MyriaApply(x=$0,y=$10)", "opId": 26, "emitExpressions": [{"rootExpressionOperator": {"columnIdx": 0, "type": "VARIABLE"}, "outputName": "x"}, {"rootExpressionOperator": {"columnIdx": 10, "type": "VARIABLE"}, "outputName": "y"}]}, {"opName": "MyriaStore(public:adhoc:fb_q5_HC_LFJ)", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "fb_q5_HC_LFJ"}, "argOverwriteTable": true, "argChild": 26, "opType": "DbInsert", "opId": 27}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:actor_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "actor_film"}, "opId": 28}, {"opName": "MyriaHyperShuffleProducer(h(0),h(1),*,*,*,*,*,*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], [32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]], "hashedColumns": [0, 1], "mappedHCDimensions": [0, 1], "argChild": 28, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 22}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:perform_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "perform_film"}, "opId": 29}, {"opName": "MyriaHyperShuffleProducer(*,h(0),h(1),*,*,*,*,*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]], "hashedColumns": [0, 1], "mappedHCDimensions": [1, 2], "argChild": 29, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 19}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:actor_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "actor_film"}, "opId": 30}, {"opName": "MyriaHyperShuffleProducer(h(0),*,*,h(1),*,*,*,*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23], [8, 9, 10, 11, 12, 13, 14, 15, 24, 25, 26, 27, 28, 29, 30, 31], [32, 33, 34, 35, 36, 37, 38, 39, 48, 49, 50, 51, 52, 53, 54, 55], [40, 41, 42, 43, 44, 45, 46, 47, 56, 57, 58, 59, 60, 61, 62, 63]], "hashedColumns": [0, 1], "mappedHCDimensions": [0, 3], "argChild": 30, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 16}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:perform_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "perform_film"}, "opId": 31}, {"opName": "MyriaHyperShuffleProducer(*,*,*,h(0),h(1),*,*,*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23, 32, 33, 34, 35, 36, 37, 38, 39, 48, 49, 50, 51, 52, 53, 54, 55], [8, 9, 10, 11, 12, 13, 14, 15, 24, 25, 26, 27, 28, 29, 30, 31, 40, 41, 42, 43, 44, 45, 46, 47, 56, 57, 58, 59, 60, 61, 62, 63]], "hashedColumns": [0, 1], "mappedHCDimensions": [3, 4], "argChild": 31, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 13}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:perform_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "perform_film"}, "opId": 32}, {"opName": "MyriaHyperShuffleProducer(*,*,h(1),*,*,h(0),*,*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 2, 3, 8, 9, 10, 11, 16, 17, 18, 19, 24, 25, 26, 27, 32, 33, 34, 35, 40, 41, 42, 43, 48, 49, 50, 51, 56, 57, 58, 59], [4, 5, 6, 7, 12, 13, 14, 15, 20, 21, 22, 23, 28, 29, 30, 31, 36, 37, 38, 39, 44, 45, 46, 47, 52, 53, 54, 55, 60, 61, 62, 63]], "hashedColumns": [1, 0], "mappedHCDimensions": [2, 5], "argChild": 32, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 10}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:actor_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "actor_film"}, "opId": 33}, {"opName": "MyriaHyperShuffleProducer(*,*,*,*,*,h(1),h(0),*)", "opType": "HyperShuffleProducer", "cellPartition": [[0, 1, 8, 9, 16, 17, 24, 25, 32, 33, 40, 41, 48, 49, 56, 57], [2, 3, 10, 11, 18, 19, 26, 27, 34, 35, 42, 43, 50, 51, 58, 59], [4, 5, 12, 13, 20, 21, 28, 29, 36, 37, 44, 45, 52, 53, 60, 61], [6, 7, 14, 15, 22, 23, 30, 31, 38, 39, 46, 47, 54, 55, 62, 63]], "hashedColumns": [1, 0], "mappedHCDimensions": [5, 6], "argChild": 33, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 7}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:actor_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "actor_film"}, "opId": 34}, {"opName": "MyriaHyperShuffleProducer(*,*,*,*,*,*,h(0),h(1))", "opType": "HyperShuffleProducer", "cellPartition": [[0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60], [1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61], [2, 6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62], [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51, 55, 59, 63]], "hashedColumns": [0, 1], "mappedHCDimensions": [6, 7], "argChild": 34, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 4}]}, {"operators": [{"opName": "MyriaScan(public:adhoc:perform_film)", "opType": "TableScan", "relationKey": {"userName": "public", "programName": "adhoc", "relationName": "perform_film"}, "opId": 35}, {"opName": "MyriaHyperShuffleProducer(*,*,*,*,h(1),*,*,h(0))", "opType": "HyperShuffleProducer", "cellPartition": [[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63]], "hashedColumns": [1, 0], "mappedHCDimensions": [4, 7], "argChild": 35, "hyperCubeDimensions": [2, 2, 1, 2, 1, 2, 2, 2], "opId": 1}]}], "type": "SubQuery"}}